# Changelog // Night City OS

All notable changes to the "Night City OS" project will be documented in this file.

## [v5.1.1] - Stability & Governance - 2025-12-27
### Added
- Centralized validation + logging utilities to harden transaction ingestion and file uploads.
- Documentation refresh across README, Architecture, and Security guides to reflect 5.1 safeguards and operational workflows.
- Validation-focused unit coverage to protect receipt ingestion and finance mutations.
- Strategic Operations module: mission-style goal engine (vaults, debt liquidation, burn limiters) with FIRE/legacy simulations and round-up daemons.
- Recharts + `decimal.js` pulled in for precision projections and visualizations.
### Changed
- Finance, shopping, and psycho widgets cleaned for lint compliance, clearer labels, and safer state hydration.
- Package metadata aligned to v5.1.1 to track stability release.
- README architecture diagram updated to render correctly in GitHub Mermaid.
- Lint budget tightened (zero-warning policy) across new Strategic Ops module.
### Fixed
- Window manager effect dependencies and shopping list initialization to prevent stale updates and rendering edge cases.
- Round-up daemon now uses deterministic Decimal-based ceiling for siphon math.

## [v5.1.0] - The Social Update - 2025-12-26
### Added
- **Shared Spaces:**
  - **Multi-User Support:** Create and switch between Personal, Family, and Roommate spaces.
  - **Role-Based Access Control:** Admin (Manage Everything), Editor (Edit Data), Viewer (Read Only).
  - **Member Management:** Add/Remove members via the new Space Settings modal.
- **Collaborative Finance:**
  - **Bill Splitting:** Split transactions between space members with visual feedback.
  - **Shared Goals:** Track savings targets collectively (e.g., "Arasaka Cyberdeck").
  - **Collaborative Shopping List:** Real-time synced checklist for household needs.
  - **Group Challenges:** Gamified widget for tracking "No Spend" or "Savings Race" challenges.
- **Security & Governance:**
  - **Approval Workflows:** Transactions exceeding a configurable threshold (default 1000) require Admin approval.
  - **Spending Limits:** Allowance/Teen mode support via permission checks.
  - **Audit Logging:** Permission denials and approvals are logged.
## [Unreleased]
### Fixed
- **Calculator:** Improved floating point precision handling. Fixed regression where large integers were losing precision (e.g. `1234567890123`) while maintaining fix for `0.1 + 0.2` epsilon errors.

## [v5.0.0] - The Neural Link Update - 2025-12-25
### Added
- **Core Intelligence:**
  - **Auto-Categorization v2:** Context-aware transaction tagging (Loc/Merchant).
  - **Smart Recategorization:** Neural Training UI allows users to teach the OS new rules.
  - **Recurring Detection:** Auto-identification of subscriptions (Netflix, Spotify).
  - **Voice Expenses:** Support for audio notes in DesktopUploadWidget (Speech-to-Text extraction).
- **Advanced Finance:**
  - **Multi-Currency:** Live conversion for €$, USD, JPY, BTC.
  - **Asset Tracking:** New "Assets" tab for physical assets and subscription management.
  - **Export Engine:** CSV Export functionality for transactions.
  - **Tax Tagging:** Automated tax-deductible flagging.
- **Security Suite:**
  - **Privacy Mode:** Blur sensitive data with [CTRL+SHIFT+P].
  - **Audit Logs:** System-wide security logging (Boot, Privacy, Anomaly).
  - **Anomaly Detection:** Alerts for transactions > 10,000 €$.
- **UX Polish:**
  - **Neural Search:** Natural language app launching via Taskbar.

## [v4.0.0] - Gold Master - 2025-12-25
### Released
- **Stable Build:** Achieved 100% lint compliance and successful production build.
- **Repository Hygiene:** Implemented professional `.gitignore` to exclude system files (`.DS_Store`) and developer artifacts (`coverage/`, `.vscode/`, `.agent/`).
- **Codebase Polish:** Final debug pass on `FinancialTracker` preventing UI glitches from invalid categories.

## [v3.5.0] - Modular Architecture & UI Polish - 2025-12-25
### Added
- **Financial Tracker v2.0:**
  - Tabbed interface (Overview, Analytics, AI Insights).
  - Animated Donut Charts and Spend Trends.
  - "Gemini Advisor" module for AI-driven financial recommendations.
  - Enhanced Receipt Vision (Gemini 2.5) with category extraction.
- **Glassmorphism UI:** New `WindowFrame` component with frosted glass effects and refined borders.
- **Modular Apps:** Extracted all core apps (`Calculator`, `Settings`, `Terminal`, `MusicPlayer`) into dedicated files in `src/apps/`.

### Changed
- **Architecture:** Major refactor of `WinOS.jsx`, delegating app logic to standalone components.
- **Theme System:** Centralized color tokens in `src/utils/theme.js`.

### Fixed
- **Build Config:** Resolved `__dirname` issues in `vite.config.js` by adopting `import.meta.url`.
- **Linting:** Cleared unused variables and React imports for cleaner code.

## [v3.2.0] - Production Audit & Infrastructure - 2025-12-25
### Added
- **CI/CD Pipeline:** Integrated GitHub Actions for automated linting, testing, and building.
- **Testing Suite:** Added Vitest and React Testing Library for component and utility validation.
- **Pre-commit Hooks:** Enabled Husky and lint-staged to ensure code quality before commits.
- **Legal & Compliance:** Added MIT License, Contributing Guide, Code of Conduct, and Security Policy.
- **Advanced Theming:** Refactored global CSS to use CSS Variables synchronized with React state.
- **Modular Hooks:** Extracted `usePersistentState` and `useViewport` into reusable logic modules.

### Changed
- **Architecture:** Transitioned from a monolithic structure to a modular organization (Hooks, Utils, Styles).
- **Styling:** Switched to standard Google Fonts (Rajdhani, Share Tech Mono) for premium aesthetics.
- **Directory Structure:** Reorganized assets and code under functional subdirectories.

## [v3.1.0] - Comprehensive OS Upgrade - 2025-12-25
### Added
- **Global Glitch CSS:** Implemented Cyberpunk 2077-style text/image glitch effects using `clip-path` and keyframes.
- **New Core Apps:**
  - **Calculator:** Functional arithmetic with precision handling.
  - **Music Player:** "Cyber-Amp" with visualizers, progress bar, and playlist cycling.
  - **Settings:** Configurable Background Fit (Cover/Contain/Fill) and system volume visuals.
- **Persistence:** `usePersistentState` now saves Windows, Files, and Config to `localStorage` across reloads.
- **Mobile Lockout:** "System Error" screen for devices < 768px width to preserve desktop immersion.
- **GitHub Deployment:** Initialized git repository and pushed to [Raoof128/night_city_os](https://github.com/Raoof128/night_city_os).

### Fixed
- **React Hooks:** Fixed conditional Hook execution bug in mobile check logic.
- **Stability:** Added `try-catch` blocks to storage logic to prevent crashes from data corruption.
- **Math:** Fixed floating point errors in Calculator.


## [v3.0.0] - Final Cut - 2025-12-25

### Added
- **Text Pad App:** Fully functional note-taking app with "Saved" state simulation.
- **Image Viewer:** Double-clicking shards now opens a "Decryption" viewer.
- **Toast Notifications:** System-wide alert bubbles (e.g., "Transaction Verified", "Data Shard Received").
- **Shutdown Sequence:** "Jack Out" now triggers a full system halt screen with manual reboot.
- **Context Menu Actions:**
  - "Display Settings" now toggles Stealth Mode (disables CRT/Grid noise).
  - "System Integrity" runs a diagnostic scan.

### Fixed
- **Context Menu Bug:** Fixed issue where right-click menu would stay stuck open. Now auto-closes on interaction.
- **Z-Index Issues:** Windows now correctly layer on top of each other when focused.

## [v2.1.0] - Desktop Operations - 2025-12-25

### Added
- **Right-Click Context Menu:** Custom UI replacing the browser default.
- **Grid Reset:** "RESET_GRID" daemon to snap all icons back to default positions.
- **Draggable Desktop:** All icons and widgets (Calendar, Upload) are now draggable via framer-motion.

## [v2.0.0] - Netrunner Update - 2025-12-25

### Added
- **Network Map App:** Animated SVG visualizer replacing the static "Net" icon.
- **Dual-Sync Calendar:** Widget displaying Solar Hijri (Persian) and Gregorian dates.
- **Active Window Management:** Implemented `bringToFront` logic for window layering.
- **CRT Overlays:** Added global scanlines and vignette effects.

### Changed
- **Calendar Widget:** Moved to desktop top-left (later moved to right) and restyled with high-contrast Black clock icon.

## [v1.3.0] - Night City Palette - 2025-12-25

### Changed
- **Visual Overhaul:** Switched from "Persian Blue" theme to Cyberpunk 2077 Official (Yellow/Red/Black).
- **Background:** Added dynamic wallpaper support with overlaid CSS grids and gradients.

### Added
- **Gemini Vision Integration:** DesktopUploadWidget now accepts images, sends them to Gemini 2.5 Flash, and updates the Finance App state.
- **Terminal 1.0:** Basic command parsing structure.

## [v1.0.0] - Initial Concept - 2025-12-25

### Initialized
- Project kick-off.
- Basic "WebOS" card concept (deprecated in favor of Desktop Window Manager).
- Basic React + Tailwind setup.
